<div fxLayout="column" class="full-height network-content">

  <div fxLayout="row">
    <mat-input-container fxFlex floatingPlaceholder="false">
      <input matInput placeholder="Search for contacts..." [(ngModel)]="query" (keyup.enter)="search()">
    </mat-input-container>
    <button mat-icon-button (click)="search()">
      <mat-icon class="mat-24">search</mat-icon>
    </button>
  </div>

  <div fxLayout="row" *ngIf="!_query" fxFlex>
    <span>Please select or enter a name to search.</span>
  </div>

  <div fxLayout="row" *ngIf="loading" fxFlex>
    <spinner [loading]="loading"></spinner>
  </div>

  <div fxLayout="row" *ngIf="_query && !loading && (!contacts || contacts.length == 0)" fxFlex>
    <span>No contacts found!</span>
  </div>

  <div fxLayout="column" class="results-list-wrapper scrollable" *ngIf="_query && !loading" fxFlex>
    <div class="contact-network-container" *ngFor="let contact of contacts;">
      <div fxLayout="row" class="primary-contact-container" (click)="openDialog(contact)">
        <div fxFlex="10" fxLayout="column" class="primary-icon-container">
          <img src="assets/img/network/primary_contact_dark.png" class="icon"/>
        </div>
        <div fxFlex="90" fxLayout="column" class="primary-details-container">
          <div fxLayout="row" class="primary-details-name text-overflow">
            {{contact.firstName}} {{contact.lastName}}
          </div>
          <div fxLayout="row" class="primary-details-description" *ngIf="contact.description">
            {{contact.description}}
          </div>
          <div fxLayout="row" class="primary-details-description" *ngIf="!contact.description">
            <i>No company details</i>
          </div>
        </div>
      </div>
      <ng-container *ngFor="let secondaryContact of contact.secondaryContacts; index as i;">
        <div fxLayout="row" class="secondary-contact-container" *ngIf="i < 3 || contact.showAllRelations"
             (click)="openDialog(secondaryContact)">
          <div fxFlex="20" fxLayout="column" class="secondary-icon-container">
            <img src="assets/img/network/secondary_contact_light.png" class="icon"/>
          </div>
          <div fxFlex="80" fxLayout="column" class="secondary-details-container">
            <div fxFlex="{{secondaryContact.businessCompany ? '50' : '100'}}"
                 class="secondary-details-name text-overflow">
              {{secondaryContact.firstName}} {{secondaryContact.lastName}}
            </div>
            <div fxFlex="50" class="secondary-details-company text-overflow" *ngIf="secondaryContact.businessCompany">
              {{secondaryContact.businessCompany}}
            </div>
          </div>
        </div>
      </ng-container>
      <div fxLayout="row" class="show-more-container" (click)="contact.showAllRelations = !contact.showAllRelations;"
           *ngIf="contact.secondaryContacts && contact.secondaryContacts.length > 3">
        <div fxFlex="20" fxLayout="column" class="show-more-icon">
          <img src="assets/img/network/show_more_light.png" class="icon"/>
        </div>
        <span fxFlex="80" fxLayout="column" class="show-more-text" *ngIf="!contact.showAllRelations">
          Show more... ({{contact.secondaryContacts.length - 3}})
        </span>
        <span fxFlex="80" fxLayout="column" class="show-more-text" *ngIf="contact.showAllRelations">
          Show less...
        </span>
      </div>
    </div>
  </div>

</div>
